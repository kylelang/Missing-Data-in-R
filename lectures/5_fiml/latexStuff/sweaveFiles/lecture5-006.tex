\begin{Schunk}
\begin{Sinput}
 ## Subset mu, sigma, and inData to only work
 ## with the observed parts of inData:
 isObs <- !is.na(inData[i, ])
 nVar <- sum(isObs)
 llVec[i] <- -0.5 * nVar * log(2 * pi) -
     0.5 * log(det(sigmaHat[isObs, isObs])) -
         0.5* (inData[i, isObs] - muHat[isObs]) %*%
             solve(sigmaHat[isObs, isObs]) %*%
                 matrix(inData[i, isObs] - muHat[isObs])
\end{Sinput}
\end{Schunk}
