\begin{Schunk}
\begin{Sinput}
 parms <- list()
 parms$nObs <- 1000
 parms$meanVec <- c(1.0, 2.0, 3.0)# x, y, z
 parms$corVec <- c(0.2, 0.5, 0.4)# xy, xz, yz
 ## Create some toy data:
 simData <- simulateSimpleData(parms)
 ## Vector of starting values for the parameters:
 startVec <- c(rep(0.5, 3),
               c(1.0, 0.3, 0.3,
                 0.3, 1.0, 0.3,
                 0.3, 0.3, 1.0))
 ## Use optimx() to numerically optimize the LL function:
 llOpt <- optimx(startVec,
                 fn = myLL,
                 inData = as.matrix(simData),
                 method = "L-BFGS-B",
                 lower = 0.0,
                 control = list(maximize = TRUE,
                     kkt = FALSE))
\end{Sinput}
\begin{Soutput}
Maximizing -- use negfn and neggr
\end{Soutput}
\begin{Sinput}
 ## Get the optimize mean vector and covariance matrix:
 muHatLL <- llOpt[1 : 3]
 sigmaHatLL <- matrix(as.numeric(llOpt[4 : 12]), ncol = 3)
 ## Look at the results:
 muHatLL
\end{Sinput}
\begin{Soutput}
               p1       p2       p3
L-BFGS-B 1.033976 1.985203 3.009896
\end{Soutput}
\begin{Sinput}
 sigmaHatLL
\end{Sinput}
\begin{Soutput}
          [,1]      [,2]      [,3]
[1,] 1.0125147 0.1805506 0.4952722
[2,] 0.1805501 0.9265573 0.3427037
[3,] 0.4952725 0.3427032 0.9519676
\end{Soutput}
\end{Schunk}
