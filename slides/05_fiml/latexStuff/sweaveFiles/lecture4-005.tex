\begin{Schunk}
\begin{Sinput}
 nObs <- 1000 # Sample Size
 pm <- 0.3 # Proportion Missing
 sigma <- matrix(c(1.0, 0.5, 0.0,
                   0.5, 1.0, 0.3,
                   0.0, 0.3, 1.0),
                 ncol = 3)
 simData <- as.data.frame(rmvnorm(nObs, c(0, 0, 0), sigma))
 colnames(simData) <- c("y", "x", "z")
 ## Impose MAR Nonresponse:
 missData <- simData
 rVec <- pnorm(missData$x,
               mean = mean(missData$x),
               sd = sd(missData$x)) < pm
 missData[rVec, "y"] <- NA
 ## Summarize and subset the data:
 nMissing <- sum(rVec)
 nObserved <- sum(!rVec)
 yMiss <- missData[rVec, ]
 yObs <- missData[!rVec, ]
 missPredData <- cbind(1, as.matrix(yMiss[ , c("x", "z")]))
 obsPredData <- cbind(1, as.matrix(yObs[ , c("x", "z")]))
\end{Sinput}
\end{Schunk}
