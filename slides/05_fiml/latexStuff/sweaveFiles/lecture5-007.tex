\begin{Schunk}
\begin{Sinput}
 ## FIML loglikelihood function:
 myFIML <- function(parVec, inData)
 {
     ## Extract the parameter matrices:
     nVar <- ncol(inData)
     muHat <- parVec[1 : 3]
     sigmaHat <- matrix(parVec[4 : 12], ncol = 3)
 
     ## Compute the row-wise -2LogLikelihoods:
     llVec <- rep(NA, nrow(inData))
     for(i in 1 : nrow(inData)) {
         ## Subset mu, sigma, and inData to only work
         ## with the observed parts of inData:
         isObs <- !is.na(inData[i, ])
         nVar <- sum(isObs)
 
         llVec[i] <- -0.5 * nVar * log(2 * pi) -
             0.5 * log(det(sigmaHat[isObs, isObs])) -
                 0.5 * (inData[i, isObs] - muHat[isObs]) %*%
                     solve(sigmaHat[isObs, isObs]) %*%
                         matrix(inData[i, isObs] - muHat[isObs])
     }
     sum(llVec) # return the overall LL value
 }
\end{Sinput}
\end{Schunk}
